


@font-face{
  font-family:"Cascadia";
  src:
    local("Cascadia Code"),
    local("Cascadia Mono"),
    local("Cascadia"),
    url("fonts/Cascadia.ttf") format("truetype");
  font-display: swap;
}



:root{

  --font: "Cascadia","Cascadia Code","Cascadia Mono",ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace;


  
  --header-h: 48px;
  --timeline-h: 190px;

  --sidebar-w: 300px;
  --rightbar-w: 340px;

  --dock-gap: 14px;          
  --dock-gap-bottom: 8px;    

  --frame-w: 24px;

  


  
  --border: #1e2430;
  --ink: #e9eef3;
  --muted: #9aa7b7;
  --accent: #e53935;

  --bg: #0b0e12;
  --panel: #131821;
  --panel2:#0f1319;
  --sticky: #10151d;

  --btn-bg: #1a212c;
  --btn-bd: #2a3240;
  --btn-bg-h: #233044;
  --btn-bd-h: #3b4a61;

  --shadowDock: 0 12px 32px rgba(0,0,0,.45);
  --shadowTop: 0 6px 18px rgba(0,0,0,.35);
}

[hidden]{
  display:none !important;
}

*{ box-sizing:border-box; }
html,body{ 
  
  height:100%; margin:0; 
  font-family: var(--font);
}
html{ overflow-y: scroll; }

body{
  background:var(--bg);
  color:var(--ink);

  font-size: var(--ui-font);
  line-height: 1.35;
  font-family: var(--font);

  overflow:hidden;               
  overscroll-behavior:none;
}


#stage, #drawCanvas, #fxCanvas, #boundsCanvas{
  touch-action:none;
  -ms-touch-action:none;
}


#floatingIslandHeader{ touch-action: none; }



header.top{
  height: var(--header-h);
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;

  padding: 10px 14px;
  border-bottom: 1px solid var(--border);
  background: #0f141b;
}


header.top .topSlot{
  min-width: 0;
  display: flex;
  align-items: center;
}

header.top .topSlot.left{
  justify-content: flex-start;
}

header.top .topSlot.right{
  justify-content: flex-end;
}

.brandIcon{
  width: 22px;
  height: 22px;
  border-radius: 6px;
  background: url("./icons/ginyospace.ico") center / contain no-repeat;
  box-shadow: 0 0 0 2px #000 inset;
}

.brandIconR{
  background-image: url("./icons/favicon.ico");
}


.brand{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:800;
  letter-spacing:.5px;
}
.brand .logo{
  width:22px;
  height:22px;
  border-radius:6px;
  background:linear-gradient(135deg,#e53935,#ffcc00 60%,#00e5ff);
  box-shadow:0 0 0 2px #000 inset;
}



[data-layer-row].swatchLayerDropTarget{
  outline: 2px solid rgba(120,200,255,0.65);
  outline-offset: 2px;
  border-radius: 10px;
}




.topBtn{
  padding: 8px 10px;
  border-radius: 0px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(0,0,0,.35);
  color: #fff;
  font: inherit;
  cursor: pointer;
}
.topBtn:hover{ background: rgba(255,255,255,.08); }



header.top{
  position: relative;
  z-index: 9200;
}

.infoBackdrop{
  position: fixed;
  inset: 0;
  z-index: 9100;

  
  background: transparent;

  
  pointer-events: none;

  
  opacity: 0;
  transition: opacity 180ms ease;
}

.infoBackdrop.isOpen{
  pointer-events: auto;
  opacity: 1; 
}

.infoPanel{
  position: fixed;

  pointer-events: none;

  
  top: calc(var(--header-h) + 10px);
  right: 10px;
  height: min(620px, calc(100dvh - var(--header-h) - 20px));
  width: min(360px, 92vw);


  font-size: 12px;
  line-height: 1.25;


  border-radius: 0px; 
  overflow: hidden;    

  
  background: rgba(18, 20, 24, 0.92);
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: -18px 0 50px rgba(0,0,0,.55);
  z-index: 9150;

  display: flex;
  flex-direction: column;
  outline: none;

  transform: translateX(102%);
  transition: transform 220ms cubic-bezier(.22,.61,.36,1);
  opacity: 0;
  filter: blur(4px);
}

.infoPanel.isOpen{
  transform: translateX(0);
  opacity: 1;
  filter: blur(0);
  pointer-events: auto;
}

.infoHeader{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 12px 12px;
  border-bottom: 1px solid rgba(255,255,255,.12);
}

.infoTitle{
  font-weight: 700;
  letter-spacing: .06em;
  font-size: 12px;
}

.infoText{ font-size: 15px; }
.infoList{ 
  
  
  font-size: 12px; 
  padding-left: 18px;  
  margin: 10px 0;

}
.infoLinkBtn{ font-size: 12px; padding: 8px 10px; }

.infoList li{
  margin: 8px 0;       
}


.infoBody{
  padding: 12px 12px 16px;
  overflow: auto;
}

.infoText{
  margin: 0 0 12px;
  opacity: .92;
  line-height: 1.35;
}

.infoBtns{
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
  margin-bottom: 12px;
}

.infoLinkBtn{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  padding: 10px 12px;
  border-radius: 0px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.06);
  color: #fff;
}
.infoLinkBtn:hover{ background: rgba(255,255,255,.10); }

.infoHr{
  border: none;
  border-top: 1px solid rgba(255,255,255,.12);
  margin: 10px 0 12px;
}

.infoH3{
  margin: 0 0 8px;
  font-size: 14px;
  opacity: .95;
}

.infoList{
  margin: 0;
  padding-left: 18px;
  opacity: .9;
  line-height: 1.35;
}


#layerSeg label{
  display:flex;
  align-items:center;
  gap:10px;
}

#layerSeg .visBtn{
  width:26px;
  height:26px;
  border-radius:8px;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06);
  color:#fff;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  flex:0 0 auto;
  font-size:16px;
  line-height:1;
  padding:0;
}
#layerSeg .visBtn:hover{ background: rgba(255,255,255,0.08); }
#layerSeg .visBtn.is-hidden{ opacity:0.45; filter: grayscale(1); }

#layerSeg .layerSwatches{
  margin-left:auto;
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:6px;
  flex-wrap:wrap;
}



#layerSeg label{
  display:flex;
  align-items:center;
  gap:8px;
}

#layerSeg .visBtn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:28px;
  height:28px;
  border:0;
  border-radius:8px;
  background:transparent;
  cursor:pointer;
  font-size:16px;
  line-height:1;
}

#layerSeg .visBtn.is-hidden{
  opacity:.55;
}


#layerSeg .visBtn:hover{
  background: rgba(255,255,255,0.08);
}

#layerSeg .visBtn.is-hidden{
  opacity: 0.45;
  filter: grayscale(1);
}



#layerSeg label{
  display:flex;
  align-items:center;
  gap:10px;
}

#layerSeg .layerName{
  display:inline-flex;
  align-items:center;
}

#layerSeg .layerSwatches{
  margin-left:auto;
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:6px;
  flex-wrap:wrap;
}

#layerSeg .layerSwatchBtn{
  width:16px;
  height:16px;
  border-radius:0px;
  border:1px solid var(--btn-bd);
  padding:0;
  cursor:pointer;
  background:#000;
}

.layerSwatchBtn.swatchDragging{
  transform: scale(1.06);
  outline: 2px solid rgba(255,255,255,0.35);
}

body.swatch-reordering{
  cursor: grabbing;
}




.layerSwatchBtn.activeOnActiveLayer{
  box-shadow:
    0 0 0 2px #00e676,
    0 0 0 1px rgba(0,0,0,.55) inset;
}


.layerSwatchBtn{
  position: relative;
  margin-left: calc(var(--swatchDepth, 0) * 12px);
}


.layerSwatchBtn[data-hidden-by-folder="1"]{
  display: none;
}


.layerSwatchBtn .swatchCaret{
  position: absolute;
  left: 6px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 12px;
  line-height: 1;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,.7);
  pointer-events: auto;
  user-select: none;
}

.layerSwatchBtn{ position:relative; }

#swatchCtxMenu{
  min-width: 170px;
  padding: 6px;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 10px;
  background: rgba(18,18,18,.95);
  backdrop-filter: blur(10px);
  box-shadow: 0 12px 40px rgba(0,0,0,.55);
}

#swatchCtxMenu button{
  width: 100%;
  display: block;
  border: 0;
  background: transparent;
  color: #fff;
  text-align: left;
  padding: 10px 10px;
  border-radius: 8px;
  cursor: pointer;
  font: 600 13px/1.1 system-ui, sans-serif;
}

#swatchCtxMenu button:hover{
  background: rgba(255,255,255,.08);
}

#swatchCtxMenu button.danger{
  color: #ff6b6b;
}

#swatchCtxMenu{
  position: fixed;
  z-index: 99999;
  min-width: 160px;
  background: #111;
  border: 1px solid #333;
  border-radius: 10px;
  box-shadow: 0 10px 30px rgba(0,0,0,.45);
  padding: 6px;
}

#swatchCtxMenu button{
  width: 100%;
  text-align: left;
  background: transparent;
  border: 0;
  color: #eee;
  padding: 10px 10px;
  border-radius: 8px;
  cursor: pointer;
  font: inherit;
}

#swatchCtxMenu button:hover{
  background: rgba(255,255,255,.08);
}


#layerOpacityMenu{
  position: fixed;
  z-index: 2147483600;
  min-width: 220px;
  padding: 10px 10px 9px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(18,20,26,0.98);
  box-shadow: 0 14px 40px rgba(0,0,0,0.55);
  color: #fff;
}

#layerOpacityMenu .lom-title{
  font-size: 12px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  opacity: 0.85;
  margin-bottom: 8px;
}

#layerOpacityMenu #lomRange{
  width: 100%;
}

#layerOpacityMenu .lom-row{
  margin-top: 8px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

#layerOpacityMenu .lom-val{
  font-size: 12px;
  opacity: 0.9;
  font-variant-numeric: tabular-nums;
}

#layerOpacityMenu .lom-reset{
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.08);
  color: inherit;
  cursor: pointer;
}

#layerOpacityMenu .lom-reset:hover{
  background: rgba(255,255,255,0.14);
}


#layerRowMenu{
  position: fixed;
  z-index: 99999;
  background: #161a20;
  border: 1px solid #2a3340;
  border-radius: 10px;
  padding: 6px;
  min-width: 180px;
  box-shadow: 0 18px 48px rgba(0,0,0,0.55);
}

#layerRowMenu .lrm-btn{
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  padding: 8px 10px;
  border: 0;
  border-radius: 8px;
  background: transparent;
  color: #e7edf6;
  cursor: pointer;
  text-align: left;
}

#layerRowMenu .lrm-btn:hover{
  background: rgba(255,255,255,0.06);
}

#layerRowMenu .lrm-btn:disabled{
  opacity: 0.45;
  cursor: default;
}

#layerRowMenu .lrm-chk{
  width: 1.3em;
  display: inline-block;
  text-align: center;
  opacity: 0.9;
}


.clipBadge{
  margin-left: 6px;
  margin-right: 6px;
  font-size: 12px;
  opacity: 0.8;
}

label.isClippedToBelow .clipBadge{
  opacity: 1;
}


:where(button, .seg input + label, .dock-btn, .edge-btn){
  background:var(--btn-bg);
  color:#dfe7f1;
  border:1px solid var(--btn-bd);
  border-radius:10px;
  padding:8px 10px;
  cursor:pointer;
}
:where(button, .seg input + label, .dock-btn, .edge-btn):hover{
  background:var(--btn-bg-h);
  border-color:var(--btn-bd-h);
}

.row{
  display:flex;
  align-items:center;
  gap:8px;
  margin:6px 0;
  flex-wrap:wrap;
}
.row label{
  color:#c7d0db;
  min-width:108px;
}

.btns{ display:flex; flex-wrap:wrap; gap:8px; }

.seg{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
}
.seg input{ display:none; }
.seg label{
  user-select:none;
  padding:6px 12px;
  height:28px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:220px;
}
.seg input:checked + label{
  background:var(--btn-bg-h);
  border-color:var(--btn-bd-h);
}


#layerSeg > input:checked + label{
  border-color: #00e676 !important;
  box-shadow: 0 0 0 2px #00e676 inset;
}

.chip{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:4px 8px;
  border:1px solid var(--btn-bd);
  border-radius:8px;
  background:#151c26;
  font-size:12px;
  color:#c7d0db;
}
.swatch{
  width:16px;
  height:16px;
  border-radius:4px;
  border:1px solid var(--btn-bd);
}

.badge{
  font-size:12px;
  color:#c7d0db;
  background:#1a2230;
  border:1px solid var(--btn-bd);
  border-radius:999px;
  padding:3px 10px;
}


.app{
  position:relative;
  width:100%;
  height: calc(100vh - var(--header-h));   
  height: calc(100dvh - var(--header-h));  
  min-height:0;
}



.app{
  --pad-left: 0px;
  --pad-right: 0px;
}
 

#brushCursorPreview{
  position: fixed;          
  left: 0; top: 0;
  width: 10px; height: 10px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  pointer-events: none;
  display: none;

  z-index: 2147483000;      

  mix-blend-mode: difference;
  border: 1px solid rgba(255,255,255,.9);
  box-shadow: 0 0 0 1px rgba(0,0,0,.55);
}




#brushCursorPreview.simple{
  border-style: solid;      
  box-shadow: none;         
}

#brushCursorPreview.eraser{
  border-style: dashed;
}






.mobileIslandToggle{
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 9999;              
  width: 46px;
  height: 46px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: rgba(12,15,20,.9);
  color: #fff;
  font-size: 22px;
  line-height: 1;
  display: none;              
  align-items: center;
  justify-content: center;
  touch-action: manipulation; 
}

@media (max-width: 900px){
  .mobileIslandToggle{ display: flex; }
}



#tlPlayheadRow{
  touch-action: none;     
  -webkit-user-select: none;
  user-select: none;
}

#islandToggleBtn,
.islandToggleBtn{
  position: relative;
  z-index: 10000;
  pointer-events: auto;
  touch-action: manipulation; 
}


#stageWrap{
  position:relative;
  height:100%;
  padding-bottom: var(--timeline-h);
  padding-left: var(--pad-left);
  padding-right: var(--pad-right);

  display:flex;
  align-items:stretch;     
  justify-content:stretch; 

  background: radial-gradient(60% 60% at 50% 50%, #0f141b, #0b0e12);
  min-height:0;

  overscroll-behavior: contain;

  touch-action: none;          
  -webkit-user-select: none;   
  user-select: none;
  
}





#stage{
  position:relative;
  flex: 1 1 auto;
  width: auto;
  height: auto;
  min-width:0;
  min-height:0;

  border:1px solid var(--border);
  background:#0c0f14;
  box-shadow: inset 0 6px 28px rgba(0,0,0,.35);



  touch-action: none;
  overscroll-behavior: contain;
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  
}



canvas#boundsCanvas,
canvas#drawCanvas,
canvas#fxCanvas{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;

  transform-origin: 0 0;   
  will-change: transform;  
}


#drawCanvas,
#boundsCanvas,
#fxCanvas{
  cursor: none !important;
}

#drawCanvas{
  touch-action: none;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

#boundsCanvas{ z-index: 1; }
#drawCanvas{ z-index: 2; }
#fxCanvas{ z-index: 3; }

#boundsCanvas,
#fxCanvas{ pointer-events:none; }


#hud{
  position:absolute;
  left:10px;
  top:10px;
  display:flex;
  gap:8px;
  align-items:center;
  background: rgba(18,22,28,.75);
  border:1px solid #293042;
  padding:6px 8px;
  border-radius:5px;
  backdrop-filter: blur(6px);
  font-size:12px;
  color:#c7d0db;
  z-index: 6;
}
#hud .sep{ width:1px; height:16px; background:#2a3240; margin:0 4px; }
#zoomInfo{ min-width:64px; text-align:right; }
#frameInfo{ min-width:86px; text-align:right; }




#tools{
  position:fixed;
  top: var(--header-h);
  left: var(--dock-gap);
  bottom: calc(var(--timeline-h) + var(--dock-gap-bottom));
  width: var(--sidebar-w);

  background: var(--panel);
  border:1px solid var(--border);
  border-radius:12px;
  padding:14px 12px;
  box-shadow: 12px 0 24px rgba(0,0,0,.25);

  overflow:auto;
  z-index: 8;
}
#tools h2{
  margin:0 0 8px;
  font-size:12px;
  color:#c7d0db;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:.08em;
}
.tool-group{
  background:#0f141b;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;
  margin-bottom: 12px;
}


#toolsRight{
  position:fixed;
  top: var(--header-h);
  right: var(--dock-gap);
  bottom: calc(var(--timeline-h) + var(--dock-gap-bottom));
  width: var(--rightbar-w);

  background: var(--panel);
  border:1px solid var(--border);
  border-radius:12px;
  padding:14px 12px;
  box-shadow: -12px 0 24px rgba(0,0,0,.25);

  overflow:auto;
  z-index: 8;
}




#islandToolsSlot #toolSeg > label[data-tool="brush"]      { --tool-icon: url("./icons/tool-brush.svg"); }
#islandToolsSlot #toolSeg > label[data-tool="eraser"]     { --tool-icon: url("./icons/tool-eraser.svg"); }
#islandToolsSlot #toolSeg > label[data-tool="fill-eraser"]{ --tool-icon: url("./icons/tool-fill-eraser.svg"); }
#islandToolsSlot #toolSeg > label[data-tool="fill-brush"] { --tool-icon: url("./icons/tool-fill-brush.svg"); }
#islandToolsSlot #toolSeg > label[data-tool="lasso-fill"] { --tool-icon: url("./icons/tool-lasso-fill.svg"); }
#islandToolsSlot #toolSeg > label[data-tool="lasso-erase"]{ --tool-icon: url("./icons/tool-lasso-erase.svg"); }
#islandToolsSlot #toolSeg > label[data-tool="rect-select"]{ --tool-icon: url("./icons/tool-rect-select.svg"); }
#islandToolsSlot #toolSeg > label[data-tool="eyedropper"]{ --tool-icon: url("./icons/tool-eyedropper.svg"); }


#islandToolsSlot #toolSeg > label{
  position: relative;              
  width: 34px !important;
  height: 34px !important;
  padding: 0 !important;
  flex: 0 0 auto !important;

  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.18);

  display: grid !important;
  place-items: center;

  font-size: 0;
  line-height: 0;
  cursor: pointer;

  
  background-image: none !important;
}


#islandToolsSlot #toolSeg > label::before{
  content: "";
  width: 20px;
  height: 20px;

  background: rgba(255,255,255,0.92); 

  -webkit-mask-image: var(--tool-icon);
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-position: center;
  -webkit-mask-size: contain;

  mask-image: var(--tool-icon);
  mask-repeat: no-repeat;
  mask-position: center;
  mask-size: contain;
}


#islandToolsSlot #toolSeg > input:checked + label{
  outline: 2px solid rgba(120, 200, 255, 0.90);
  outline-offset: 0;
}


.app.tl-collapsed #tools,
.app.tl-collapsed #toolsRight{
  bottom: var(--dock-gap-bottom);
}


.app.sidebar-collapsed #tools{ display:none; }
.app.rightbar-collapsed #toolsRight{ display:none; }


.edge-btn{
  position:fixed;
  z-index: 11;
  box-shadow: var(--shadowTop);
  padding:6px 10px;
  border-radius:8px;
}
#showLeftEdge{ top: calc(var(--header-h) + 8px); left: var(--dock-gap); display:none; }
#showRightEdge{ top: calc(var(--header-h) + 8px); right: var(--dock-gap); display:none; }
#showTimelineEdge{ bottom: 8px; left: 50%; transform: translateX(-50%); display:none; }

.app.sidebar-collapsed #showLeftEdge{ display:block; }
.app.rightbar-collapsed #showRightEdge{ display:block; }
.app.tl-collapsed #showTimelineEdge{ display:block; }


#timeline{
  position:fixed;
  left:0;
  right:0;
  bottom:0;
  height: var(--timeline-h);
  z-index: 10;

  background: var(--panel);
  border-top:1px solid var(--border);
  box-shadow: 0 -6px 16px rgba(0,0,0,.35);

  display:flex;
  flex-direction:column;
  min-height:0;
}

.app.tl-collapsed #timeline{ display:none; }
.app.tl-collapsed #stageWrap{ padding-bottom: 0; }
.app.tl-collapsed #stage{
  height: calc(100dvh - var(--header-h));
}


#timelineHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:8px 12px;
  color:#c7d0db;
  gap:10px;
  flex-wrap:wrap;
  position: relative;
}
#timelineHeader .left,
#timelineHeader .right{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}
#timelineHeader .center{
  flex: 1 1 auto;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  flex-wrap:wrap;
}


#timelineHeader #playBtn,
#timelineHeader #pauseBtn,
#timelineHeader #stopBtn,
#timelineHeader #prevFrame,
#timelineHeader #nextFrame,
#timelineHeader #jumpStart,
#timelineHeader #jumpEnd{ display:none; }

#timelineScroll{
  position:relative;
  overflow:auto;
  border-top:1px solid var(--border);
  border-bottom:1px solid var(--border);
  flex:1;
  background: var(--panel2);
  min-height:0;
}




#timelineScroll{
  scrollbar-width: thin; 
  scrollbar-color: rgba(255,255,255,0.22) rgba(0,0,0,0.18);
}


#timelineScroll::-webkit-scrollbar{
  height: 12px;  
  width: 12px;   
}

#timelineScroll::-webkit-scrollbar-track{
  background: rgba(0,0,0,0.18);
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.06);
}

#timelineScroll::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,0.20);
  border-radius: 999px;
  border: 3px solid rgba(0,0,0,0.18); 
}

#timelineScroll::-webkit-scrollbar-thumb:hover{
  background: rgba(255,255,255,0.30);
}

#timelineScroll::-webkit-scrollbar-thumb:active{
  background: rgba(255,255,255,0.38);
}


#timelineScroll::-webkit-scrollbar-corner{
  background: rgba(0,0,0,0.18);
}


#playheadMarker,
#clipStartMarker,
#clipEndMarker{
  position:absolute;
  top:0;
  bottom:0;
  width:2px;
  pointer-events:none;
}


#playheadMarker{
  
  width: var(--frame-w);
  box-sizing: border-box; 

  
  background: color-mix(in srgb, var(--accent) 18%, transparent);

  
  border-left: 2px solid var(--accent);
  border-right: 2px solid var(--accent);

  
  z-index: 5;

  
  box-shadow: none;
}



#clipStartMarker{ background:#00e676; }
#clipEndMarker{ background:#ff5252; }


table#timelineTable{
  border-collapse: separate;
  border-spacing: 0;
  font-size:12px;
  color:#c7d0db;
  user-select:none;
}
#timelineTable td,
#timelineTable th{
  border:1px solid #1f2633;
  width: var(--frame-w);
  min-width: var(--frame-w);
  height: 28px;
  text-align:center;
  padding:0;
}
#timelineTable th.sticky{
  position: sticky;
  left: 0;
  z-index: 3;
  background: var(--sticky);
  border-right:1px solid var(--border);

  min-width: 200px;
  width:200px;
  text-align:left;
  padding:0 8px;
  font-weight:600;
}
#timelineTable tr.playhead-row td{
  border-top:1px solid #2a3240;
  border-bottom:1px solid #2a3240;
  border-left:none;
  border-right:none;
  background:#131821;
  color:var(--muted);
}
#timelineTable tr.playhead-row th.sticky{
  border:1px solid #2a3240;
}
#timelineTable tr.anim-row td{ background:#0f1319; }
#timelineTable tr.anim-row td.secondTick{ background:#101722; }
#timelineTable tr.anim-row td.hasContent{
  background:#214230;
  box-shadow: inset 0 0 0 2px rgba(24, 145, 60, 0.991);

  
}
#timelineTable tr.anim-row td.active{
  outline:2px solid var(--accent);
  outline-offset:-2px;
  box-shadow:
    inset 2px 0 0 var(--accent),
    inset -2px 0 0 var(--accent);
}


#timelineTable tr.anim-row td.active.hasContent{
  box-shadow:
    inset 0 0 0 2px rgba(64, 255, 121, 0.802),
    inset 2px 0 0 var(--accent),
    inset -2px 0 0 var(--accent);
}
#timelineTable td.dropTarget{
  outline:2px solid #ffcc00;
  outline-offset:-2px;
}


.hsv-wheel{
  width: 100%;
  max-width: 320px;      
  aspect-ratio: 1 / 1;
  margin-top: 6px;
  position: relative;
  border: 1px solid var(--border);
  border-radius: 14px;
  background: #0b0e12;
  overflow: hidden;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.03);
}
.hsv-wheel-preview{
  width: 28px;
  height: 28px;
  position: absolute;
  left: 10px;
  bottom: 10px;

  border-radius: 7px;
  border: 1px solid rgba(255,255,255,0.18);
  box-shadow:
    0 0 0 2px rgba(0,0,0,0.45),
    inset 0 0 0 1px rgba(255,255,255,0.05);
  background: #000;
}

#hsvWheelCanvas{
  width: 100%;
  height: 100%;
  display: block;
  cursor: crosshair;
  touch-action: none;
}



#uiColorPickWrap{
  position: fixed;
  z-index: 99999;
  display: none;
  padding: 6px;
  border-radius: 10px;
  background: rgba(30,30,30,.92);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 30px rgba(0,0,0,.55);
  color-scheme: dark; 
}
#uiColorPickWrap input[type="color"]{
  width: 38px;
  height: 28px;
  border: 0;
  padding: 0;
  background: transparent;
  color-scheme: dark;
}



#cursorColorPicker{
  position: fixed;
  left: 0;
  top: 0;
  width: 1px;
  height: 1px;
  opacity: 0.001;   
  pointer-events: none;
  z-index: 50;
}



#timelineTable tr.anim-row td.selected{
  outline: 2px solid #00e5ff;
  outline-offset: -2px;
  background: #10212a;
}


#timelineTable tr.anim-row td.ghostTarget{
  outline: 2px dashed #00e5ff;
  outline-offset: -2px;
  background: rgba(0,229,255,.08);
}


body.dragging-cel #timelineTable tr.anim-row td.selected{
  opacity: .45;
}


#timelineTable tr.anim-row td.selected.hasContent{
  background: #0f2a24;
}

body.selecting-cels{
  cursor: crosshair;
  user-select: none;
}


body.dragging-cel{ cursor: grabbing; user-select:none; }


#timelineControlsBottom.tl-ctrls{
  display:flex;
  gap:8px;
  align-items:center;
  padding:8px 10px;
  border-top:1px solid #283241;
  background:#0c1117;
  position:sticky;
  bottom:0;
  z-index:2;
}
#timelineControlsBottom .spacer{ flex:1; }
#timelineControlsBottom button{
  padding:6px 10px;
  border-radius:8px;
  background:#131a22;
}
#timelineControlsBottom button:hover{ background:#1a222c; }

#inlineTlCtrls button{
  padding:4px 8px;
  border-radius:6px;
  background:#131a22;
}
#inlineTlCtrls button:hover{ background:#1a222c; }

button,
input,
select,
textarea{
  font-family: var(--font);
}



#timelineHeader button,
#timelineHeader input[type="number"],
#timelineHeader .chip{ min-height:36px; }



.toolOptionsPopup{
  position: fixed;
  left: 0; top: 0;
  z-index: 9999;
  display: none;
  min-width: 220px;
  max-width: 320px;

  font-family: var(--font);
  color: rgba(255,255,255,0.92);

  background: rgba(18,18,18,0.98);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 12px;
  box-shadow: 0 14px 40px rgba(0,0,0,0.55);

  padding: 10px;
}


.toolOptionsPopup button,
.toolOptionsPopup input{
  font-family: inherit;
  color: inherit;
}

.toolOptionsPopup.open{
  display: block;
}

.toolOptionsTitle{
  font-weight: 700;
  font-size: 13px;
  margin: 0 0 8px 0;
  opacity: 0.9;
}

.toolOptionsBody{
  display: grid;
  gap: 6px;
}

.toolOptBtn{
  width: 100%;
  text-align: left;

  display: flex;
  align-items: center;
  gap: 10px;

  padding: 6px 8px;                 
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04); 

  cursor: pointer;
  font-size: 12px;
  line-height: 1.2;

  appearance: none;
}

.toolOptBtn:hover{
  background: rgba(255,255,255,0.07); 
}

.toolOptBtn:focus-visible{
  outline: 2px solid rgba(255,255,255,0.22);
  outline-offset: 2px;
}


.toolOptRow{
  display: grid;
  grid-template-columns: 52px 1fr 36px;
  gap: 8px;
  align-items: center;
}

.toolOptLabel{
  font-size: 12px;
  opacity: 0.85;
}

.toolOptRange{
  width: 100%;
}

.toolOptRead{
  font-variant-numeric: tabular-nums;
  text-align: right;
  font-size: 12px;
  opacity: 0.9;
}

.toolOptCheck{
  display: flex;
  gap: 10px;
  align-items: center;
  padding: 6px 8px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  cursor: pointer;
}
.toolOptCheck:hover{
  background: rgba(255,255,255,0.07);
}
.toolOptCheck input{
  transform: translateY(0.5px);
}

.paletteBar{
  margin-top: 10px;
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  min-height: 34px;
  padding: 6px;
  border: 1px solid var(--btn-bd);
  background: #111722;
}

.paletteBar:empty{
  display: none;
  margin-top: 0;
  min-height: 0;
  padding: 0;
  border: 0;
}

.paletteSwatch{
  width: 22px;
  height: 22px;
  border: 1px solid #2d394a;
  border-radius: 0;
  padding: 0;
  cursor: pointer;
}


.dock-panel > h2{
  display:flex;
  align-items:center;
  justify-content:space-between;
  font-size:14px;
  margin:0 0 8px 0;
  padding:6px 8px;
  background:#0f141b;
  border:1px solid var(--border);
  border-radius:8px;
}
.dock-panel .dock-btns .float-btn{
  background:var(--btn-bg);
  color:#dfe7f1;
  border:1px solid var(--btn-bd);
  border-radius:6px;
  padding:2px 6px;
  cursor:pointer;
}
.dock-panel .dock-btns .float-btn:hover{
  background:var(--btn-bg-h);
  border-color:var(--btn-bd-h);
}

.floating-panel{
  position:absolute;
  z-index: 14;
  width: 320px;
  max-width: 48vw;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  box-shadow: var(--shadowDock);
  overflow:hidden;
}
.floating-panel .fp-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  background:#0f141b;
  color:#cbd3df;
  padding:8px 10px;
  border-bottom:1px solid var(--border);
  cursor: move;
  user-select:none;
}
.floating-panel .fp-title{ font-weight:600; font-size:14px; }
.floating-panel .fp-btns button{
  background:var(--btn-bg);
  color:#dfe7f1;
  border:1px solid var(--btn-bd);
  border-radius:6px;
  padding:2px 6px;
  cursor:pointer;
}
.floating-panel .fp-btns button:hover{
  background:var(--btn-bg-h);
  border-color:var(--btn-bd-h);
}
.floating-panel .fp-body{
  padding:10px;
  max-height: calc(100dvh - var(--header-h) - var(--timeline-h) - 20px);
  overflow:auto;
}




.layerRow{
  display:flex;
  align-items:center;
  gap:8px;
}


.lyVisBtn{
  width:22px;
  height:22px;
  flex:0 0 22px;

  display:grid;
  place-items:center;

  border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.06);
  color:#fff;

  border-radius:6px;
  cursor:pointer;
  user-select:none;
}

.lyVisBtn:hover{
  background:rgba(255,255,255,.10);
}


.layerRow.is-hidden .lyVisBtn{
  opacity:.35;
}

.layerRow.is-hidden .layerName,
.layerRow.is-hidden .swatchBtn{
  opacity:.55;
}



#layerVisOps .layerRows{
  display:flex;
  flex-direction:column;
  gap:6px;
  margin-top:6px;
}
#layerVisOps .row{
  display:grid;
  grid-template-columns: 18px 1fr 84px;
  align-items:center;
  gap:8px;
}
#layerVisOps .row label{
  font-size:12px;
  color:#c7d0db;
}
#layerVisOps input[type="range"]{ width:100%; }
#layerVisOps .actions{ display:flex; gap:8px; margin-top:8px; }


#colorDock{ display:none; }


@media (max-width: 900px){
  :root{
    --sidebar-w: 240px;
    --rightbar-w: 260px;
    --timeline-h: 180px;

      
    --ui-font: 14px;          
    --ui-font-tight: 12px;    
  }
  #timelineHeader .center,
  #timelineHeader .right{ gap: 8px; }
}



.tlMobArrow{ display:none; }


#timelineHeader{ position: relative; }

@media (max-width: 720px){
  :root{
    --ui-font: 12px;
    --ui-font-tight: 11px;

    --header-h: 42px;
    --timeline-h: 150px;

    --frame-w: 20px;
    --dock-gap: 10px;
    --dock-gap-bottom: 6px;
  }

  header.top{ padding: 8px 10px; }
  .brand{ gap: 8px; }
  .brand .logo{ width:18px; height:18px; border-radius:5px; }

  
  :where(button, .seg input + label, .dock-btn, .edge-btn){
    padding: 6px 8px;
    border-radius: 9px;
  }

  
  #hud{
    left: 8px; top: 8px;
    padding: 5px 7px;
    font-size: 11px;
    gap: 6px;
  }


  
  @media (max-width: 720px){

    
    #floatingIsland.islandDock{
      width: 100px;
      height: 220px;

      min-width: 180px;
      min-height: 260px;

      left: 10px;
      top: calc(var(--header-h) + 8px);
    }

    
    #floatingIsland .islandHeader{ height: 24px; padding: 0 6px; }
    #floatingIsland .islandTitle{ font-size: 11px; letter-spacing: 0.06em; }

    
    #floatingIsland .islandBtn{
      width: 22px;
      height: 20px;
      border-radius: 0; 
    }

    
    #floatingIsland .islandBody{ padding: 8px; gap: 8px; }
    #floatingIsland .islandTop{ gap: 8px; }
    #floatingIsland .islandPanel{ padding: 6px; }

    
    #floatingIsland #islandToolsSlot #toolSeg{
      grid-template-columns: repeat(2, 30px);
      grid-auto-rows: 30px;
      gap: 6px;
    }
    #floatingIsland #islandToolsSlot #toolSeg > label{
      width: 30px !important;
      height: 30px !important;
      border-radius: 0 !important;
    }
    #floatingIsland #islandToolsSlot #toolSeg > label::before{
      width: 18px;
      height: 18px;
    }

    
    #floatingIsland #islandLayersSlot #layerSeg > label{
      min-height: 32px;
      padding: 5px 6px;
      font-size: 12px;
      border-radius: 0 !important;
    }

    
    #floatingIsland #islandLayersSlot .layerSwatchBtn{
      width: 14px;
      height: 14px;
      border-radius: 0;
    }

    
    #islandSidePanel{
      width: 160px;
    }
  }

  

  
  .tlMobArrow{ display:none; }
  @media (max-width: 720px){
    .tlMobArrow{
      display: inline-flex;
      align-items: center;
      justify-content: center;

      width: 30px;
      height: 30px;
      padding: 0;

      border-radius: 10px;
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      z-index: 12;
    }

    .tlMobLeft{ left: 8px; }
    .tlMobRight{ right: 8px; }

    
    #timelineHeader{
      padding-left: 44px;
      padding-right: 44px;
    }

    
    #timelineHeader .left,
    #timelineHeader .right{
      display: none;
      position: absolute;
      bottom: calc(100% + 8px);
      z-index: 12;

      background: rgba(18, 20, 24, 0.96);
      border: 1px solid rgba(255,255,255,0.14);
      box-shadow: 0 18px 50px rgba(0,0,0,0.55);
      border-radius: 12px;
      padding: 10px;

      max-width: min(92vw, 360px);
    }

    
    #timelineHeader .left{
      left: 8px;
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
    }

    
    #timelineHeader .right{
      right: 8px;
      flex-direction: column;
      align-items: stretch;
      gap: 8px;
    }

    
    #timeline.mob-left-open #timelineHeader .left{ display: flex; }
    #timeline.mob-right-open #timelineHeader .right{ display: flex; }

    
    #timeline.mob-left-open  #tlMobLeftBtn,
    #timeline.mob-right-open #tlMobRightBtn{
      transform: translateY(-50%) rotate(180deg);
    }

    
    #timelineHeader .right button{
      padding: 6px 8px;
      border-radius: 8px;
    }
    #timelineHeader .right input[type="number"]{
      width: 64px !important;
      min-height: 32px;
    }
  }


    
  .islandDock{
    left: 10px;
    top: calc(var(--header-h) + 10px);

    width: 210px;
    height: 320px;

    min-width: 120px;
    min-height: 250px;
  }

  .islandHeader{
    height: 26px;
    padding: 0 6px;
  }

  .islandTitle{
    font-size: 11px;
    letter-spacing: 0.06em;
  }

  .islandBtns{ gap: 5px; }

  .islandBtn{
    width: 24px;
    height: 20px;
    font-size: 12px;
  }

  .islandBody{
    padding: 8px;
    gap: 8px;
  }

  .islandPanel{
    padding: 6px;
  }

  
  #islandToolsSlot #toolSeg{
    grid-template-columns: repeat(2, 30px);
    grid-auto-rows: 30px;
    gap: 6px;
  }

  #islandToolsSlot #toolSeg > label{
    width: 30px !important;
    height: 30px !important;
  }

  #islandToolsSlot #toolSeg > label::before{
    width: 18px;
    height: 18px;
  }

  
  #islandLayersSlot #layerSeg > label{
    min-height: 32px;
    padding: 5px 6px;
  }

  
  #islandSidePanel{
    width: 170px;
  }



  

  
  #timelineHeader{
    padding: 6px 8px;
    gap: 6px;
  }

  
  #timelineHeader button{
    padding: 4px 6px;
    min-height: 28px;
    border-radius: 8px;
    font-size: 11px;
    line-height: 1;
  }

  button,
  #timelineHeader button,
  #islandSidePanel .chip,
  #islandSidePanel select,
  #islandSidePanel input[type="number"],
  #islandSidePanel input[type="checkbox"]{
    min-height: 40px;
  }

  #mainBrushSizeControls{
    grid-template-columns: 1fr 64px;
  }

  
  #timelineHeader .badge{
    font-size: 10px;
    padding: 2px 7px;
  }

  
  #timelineHeader label{
    font-size: 11px;
  }

  
  #timelineHeader input[type="number"]{
    width: 54px !important;
    min-height: 28px;
    padding: 3px 6px;
    font-size: 11px;
  }

  
  #timelineHeader input[type="checkbox"]{
    transform: scale(0.9);
    transform-origin: left center;
  }
  table#timelineTable{ font-size: 11px; }
  #timelineTable td,
  #timelineTable th{ height: 24px; }
  #timelineTable th.sticky{
    width: 150px;
    min-width: 150px;
    font-size: 11px;
  }

  
  .islandDock{
    left: 10px;
    top: calc(var(--header-h) + 10px);
    width: 220px;
    height: 3340px;

    min-width: 200px;
    min-height: 260px;

    max-width: calc(100vw - 12px);
    max-height: calc(100dvh - var(--header-h) - var(--timeline-h) - 12px);
  }
  .islandBody{ padding: 8px; gap: 8px; }
  .islandPanel{ padding: 7px; }

  .islandBtn{ width: 24px; height: 20px; }

  
  #islandToolsSlot #toolSeg{
    grid-template-columns: repeat(2, 30px);
    grid-auto-rows: 30px;
    gap: 7px;
  }
  #islandToolsSlot #toolSeg > label{
    width: 30px !important;
    height: 30px !important;
  }
  #islandToolsSlot #toolSeg > label::before{
    width: 18px;
    height: 18px;
  }


  #onionOptionsStash{ display:none; }
  
  #onionCtxMenu{
    width: min(270px, calc(100vw - 16px));
  }
}


@media (max-width: 480px){
  :root{
    --ui-font: 11px;
    --ui-font-tight: 10px;

    --header-h: 40px;
    --timeline-h: 130px;

    --frame-w: 18px;
  }

  #hud{ font-size: 10px; }

  #timelineHeader .left strong{ font-size: 12px; }
  #timelineHeader input[type="number"]{
    width: 56px !important;
  }

  table#timelineTable{ font-size: 10px; }
  #timelineTable td,
  #timelineTable th{ height: 22px; }
  #timelineTable th.sticky{
    width: 130px;
    min-width: 130px;
  }

  .islandDock{
    width: 205px;
    height: 300px;
    min-width: 190px;
    min-height: 250px;
  }

  #islandSidePanel{
    width: 175px;
  }
}

  
  .islandDock{
    width: 190px;
    height: 280px;

    min-width: 170px;
    min-height: 230px;
  }

  .islandBody{
    padding: 7px;
    gap: 7px;
  }

  
  #islandToolsSlot #toolSeg{
    grid-template-columns: repeat(2, 28px);
    grid-auto-rows: 28px;
    gap: 6px;
  }

  #islandToolsSlot #toolSeg > label{
    width: 28px !important;
    height: 28px !important;
  }

  #islandToolsSlot #toolSeg > label::before{
    width: 17px;
    height: 17px;
  }

  #islandSidePanel{
    width: 160px;
  }



.islandDock{
  position: fixed;
  left: 18px;
  top: 76px;
  width: 250px;
  height: 400px;
  z-index: 40; 

  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(18, 20, 24, 0.92);
  box-shadow: 0 18px 50px rgba(0,0,0,0.55);
  border-radius: 0px;
  overflow: hidden;

  user-select: none;
  -webkit-user-select: none;

  display: flex;
  flex-direction: column;

  min-width: 240px;
  min-height: 300px;

  
  max-width: calc(100vw - 12px);
  max-height: calc(100vh - 12px);


  --island-side-gap: 0px; 
}


.islandResizeHandle{
  position: absolute;
  right: 6px;
  bottom: 6px;
  width: 16px;
  height: 16px;
  cursor: se-resize;
  opacity: 0.8;

  
  border-right: 2px solid rgba(255,255,255,0.28);
  border-bottom: 2px solid rgba(255,255,255,0.28);
}

.islandDock.resizing .islandHeader{
  cursor: se-resize;
}

.islandHeader{
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 8px;

  background: rgba(255,255,255,0.06);
  border-bottom: 1px solid rgba(255,255,255,0.10);

  cursor: grab;
}

.islandDock.dragging .islandHeader{
  cursor: grabbing;
}

.islandTitle{
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.75);
}

.islandBtns{
  display: flex;
  gap: 6px;
}

.islandBtn{
  width: 26px;
  height: 22px;
  border-radius: 0px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.18);
  color: rgba(255,255,255,0.85);
  cursor: pointer;
}

.islandBtn:active{
  transform: translateY(1px);
}

.islandBody{
  padding: 10px;
  display: grid;
  grid-template-rows: auto 1fr; 
  gap: 10px;

  flex: 1 1 auto;   
  min-height: 0;    
  overflow: hidden; 
}

.islandTop{
  display: grid;
  grid-template-columns: minmax(0, 1fr) minmax(0, 1fr); 
  gap: 10px;
  min-width: 0;
}

.islandPanel{
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.18);
  border-radius: 0px;
  padding: 8px;
  min-width: 0;
  min-height: 0;
  overflow: hidden;
}

.islandWheelSlot{
  display: grid;
  place-items: center;
  padding: 2px;
  overflow: visible;
}


#islandWheelSlot #hsvWheelWrap{
  width: 100%;
  aspect-ratio: 1 / 1;
}


#islandToolsSlot{
  min-width: 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center; 
  align-items: center;
  gap: 8px;
}


#islandToolsSlot #toolSeg{
  display: grid;
  grid-template-columns: repeat(2, 34px);
  grid-auto-rows: 34px;
  gap: 8px;

  width: fit-content;
  max-width: 100%;
}


#islandToolsSlot #toolSeg > input{
  position: absolute;
  opacity: 0;
  pointer-events: none;
}


#islandToolsSlot #toolSeg > label{
  width: 34px !important;
  height: 34px !important;
  aspect-ratio: 1 / 1;
  flex: 0 0 auto; 
  min-width: 0;
  padding: 0 !important;

  border-radius: 0px;
  border: 1px solid rgba(255,255,255,0.14);
  background-color: rgba(0,0,0,0.18);

  display: grid !important;
  place-items: center;

  background-image: var(--tool-icon);
  background-repeat: no-repeat;
  background-position: center;
  background-size: 20px 20px;

  font-size: 0;
  line-height: 0;
  cursor: pointer;
}

#islandToolsSlot #toolSeg > input:checked + label{
  outline: 2px solid rgba(120, 200, 255, 0.90);
  outline-offset: 0;
}


#islandLayersSlot{
  flex: 1 1 auto;
  min-height: 0;
  overflow: auto; 
  display: flex;
  flex-direction: column;
  gap: 8px;
  border-radius: 0px;
}


#islandLayersSlot #layerSeg{
  display: flex !important;
  flex-direction: column !important;
  flex-wrap: nowrap !important;
  
}


#islandLayersSlot #layerSeg > label{
  width: 100% !important;
  flex: 0 0 auto !important;
  border-radius: 0px;
}


#islandLayersSlot #layerSeg .layerSwatches{
  flex-wrap: nowrap !important;
  white-space: nowrap !important;
  overflow: hidden !important; 
}


#islandLayersSlot .layerSwatchBtn{
  flex: 0 0 auto !important;
}


#islandLayersSlot #layerSeg .layerName{
  flex: 0 0 auto;
}


#islandLayersSlot #layerSeg > input{
  display: none;
}




#floatingIsland,
#floatingIsland *{
  box-sizing: border-box;
}


#floatingIslandBody{
  display: flex;
  flex-direction: column;
  min-height: 0; 
}


#islandLayersSlot{
  flex: 1 1 auto;  
  min-height: 0;   
  overflow: auto;  
  display: flex;
  flex-direction: column;
  gap: 8px;
}


#islandLayersSlot #layerSeg{
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 0;
}


#islandLayersSlot #layerSeg > label{
  width: 100%;
  min-height: 36px; 
  padding: 6px 8px;
  overflow: hidden; 
}


#islandLayersSlot #layerSeg .layerSwatches{
  flex: 1 1 auto;
  min-width: 0;
  overflow: hidden;
  display: flex;
  justify-content: flex-end;
  gap: 6px;
  flex-wrap: wrap; 
}


.islandDock.collapsed .islandBody,
.islandDock.collapsed #floatingIslandBody,
#floatingIsland.collapsed .islandBody,
#floatingIsland.collapsed #floatingIslandBody{
  display: none !important;
}


.islandDock.collapsed #islandLayersSlot,
#floatingIsland.collapsed #islandLayersSlot{
  display: none !important;
}


.islandDock.collapsed #islandTab,
#floatingIsland.collapsed #islandTab{
  display: block !important;
  opacity: 1 !important;
  pointer-events: auto !important;
}


.islandDock.collapsed,
#floatingIsland.collapsed{
  height: auto !important;
  min-height: 0 !important;
}

.islandDock.collapsed .islandResizeHandle,
#floatingIsland.collapsed .islandResizeHandle{
  display: none !important;
}

#islandTab{
  display: none;
  width: 100%;
  border: 0;
  border-top: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.85);
  padding: 10px 8px;
  cursor: pointer;

  pointer-events: none;

  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}




.islandDock{ overflow: hidden; }


.islandDock.side-open{ overflow: visible; }

#islandSidePanel{
  position: absolute;
  top: 0;
  left: calc(100% + var(--island-side-gap, 10px));
  height: 100%;
  width: 190px;

  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(18, 20, 24, 0.92);
  box-shadow: 0 18px 50px rgba(0,0,0,0.55);
  border-radius: 0px;

  display: flex;
  flex-direction: column;

  opacity: 0;
  transform: translateX(-6px);
  pointer-events: none;
  transition: opacity 160ms ease, transform 160ms ease;
}

.islandDock.side-open #islandSidePanel{
  opacity: 1;
  transform: translateX(0);
  pointer-events: auto;
}

.islandSideHeader{
  height: 28px;
  display: flex;
  align-items: center;
  padding: 0 10px;

  background: rgba(255,255,255,0.06);
  border-bottom: 1px solid rgba(255,255,255,0.10);

  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.75);
}

.islandSideBody{
  flex: 1 1 auto;
  min-height: 0;
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  overflow: auto;
}



.islandSideGrid{
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.saveStateBadge{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 28px;
  padding: 4px 8px;
  font-size: 11px;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  border: 1px solid rgba(255,255,255,0.16);
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.88);
}

.saveStateBadge.dirty{
  border-color: rgba(255, 196, 102, 0.55);
  color: #ffdca2;
}

.saveStateBadge.saving{
  border-color: rgba(120, 200, 255, 0.55);
  color: #b9e6ff;
}

.saveStateBadge.error{
  border-color: rgba(255, 120, 120, 0.6);
  color: #ffc4c4;
}

.sideSelectRow{
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: rgba(255,255,255,0.85);
}

.sideSelectRow select{
  min-width: 68px;
  height: 34px;
  border-radius: 0;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.18);
  color: rgba(255,255,255,0.9);
  padding: 0 8px;
}

.mainBrushSizeGroup{
  display: flex;
  flex-direction: column;
  gap: 6px;
  width: 100%;
  max-width: 132px;
}

.mainBrushSizeGroup > label{
  font-size: 12px;
  color: rgba(255,255,255,0.8);
  letter-spacing: 0.04em;
  text-transform: uppercase;
}

.mainBrushSizeControls{
  display: grid;
  grid-template-columns: 1fr 58px;
  gap: 8px;
  align-items: center;
}

#brushSizeRange,
#brushSizeNum{
  width: 100%;
}

.sideBtn{
  height: 34px;
  border-radius: 0px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.18);
  color: rgba(255,255,255,0.85);
  cursor: pointer;
}


#islandSidePanel button,
#islandSidePanel .sideBtn{
  border-radius: 0 !important;
}

#brushSizeNum{
  min-height: 34px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.18);
  color: rgba(255,255,255,0.9);
  padding: 0 8px;
}

#brushSizeRange{
  accent-color: #e53935;
}




.sideBtn:active{ transform: translateY(1px); }

.sideBtn.wide{
  flex: 1 1 auto;
}





#onionCtxMenu{
  position: fixed;
  z-index: 9999999;
  width: 270px;
  padding: 10px;
  border-radius: 12px;

  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(18, 20, 24, 0.96);
  box-shadow: 0 18px 50px rgba(0,0,0,0.55);

  display: none;
  pointer-events: none;
  opacity: 0;
  transform: translateY(4px);
  transition: opacity 140ms ease, transform 140ms ease;
}

#onionCtxMenu.open{
  display: block;
  pointer-events: auto;
  opacity: 1;
  transform: translateY(0);
}

#onionCtxMenu .subhead{
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.75);
  margin: 2px 0 8px;
}

#onionCtxMenu .row,
#onionCtxMenu .rangeRow{
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 8px 0;
}

#onionCtxMenu .row label{
  flex: 0 0 92px;
  font-size: 12px;
  color: rgba(255,255,255,0.75);
}

#onionCtxMenu input[type="color"]{
  width: 42px;
  height: 26px;
  padding: 0;
  border: 1px solid rgba(255,255,255,0.14);
  border-radius: 8px;
  background: rgba(0,0,0,0.25);
}

#onionCtxMenu input[type="range"]{
  flex: 1 1 auto;
}

#onionCtxMenu .val{
  width: 28px;
  text-align: right;
  color: rgba(255,255,255,0.85);
  font-size: 12px;
}

#onionCtxMenu .chip{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: rgba(255,255,255,0.80);
}
